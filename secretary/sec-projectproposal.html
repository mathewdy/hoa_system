<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>HOAConnect - Resolution</title>
<script src="https://cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
<script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
<style>
  [x-cloak] {
    display: none !important;
  }
</style>
</head>
<body class="bg-gray-50">
<div class="min-h-screen flex">
  <!-- Sidebar -->
  <div class="bg-teal-800 text-white w-64 py-6 flex flex-col">
    <div class="px-6 mb-8">
      <h1 class="text-2xl font-bold">HOAConnect</h1>
      <p class="text-sm text-teal-200">Mabuhay Homes 2000</p>
    </div>
    <nav class="flex-1">
      <a href="sec-dashboard.html" class="flex items-center px-6 py-3 hover:bg-teal-700">
        <i class="fas fa-tachometer-alt mr-3"></i>
        <span>Dashboard</span>
      </a>
      <a href="sec-projectproposal.html" class="flex items-center px-6 py-3 bg-teal-700">
        <i class="fas fa-gavel mr-3"></i>
        <span>Resolution</span>
      </a>
      <a href="sec-newsfeed.html" class="flex items-center px-6 py-3 hover:bg-teal-700">
        <i class="fas fa-newspaper mr-3"></i>
        <span>News Feed</span>
      </a>
      <a href="sec-ledger.html" class="flex items-center px-6 py-3 hover:bg-teal-600">
        <i class="fas fa-book mr-3"></i>
        <span>Ledger</span>
      </a>
      <a href="sec-calendar.html" class="flex items-center px-6 py-3 hover:bg-teal-700">
        <i class="fas fa-calendar-alt mr-3"></i>
        <span>Calendar</span>
      </a>
      <a href="sec-profile.html" class="flex items-center px-6 py-3 hover:bg-teal-700">
        <i class="fas fa-user-circle mr-3"></i>
        <span>Profile</span>
      </a>
    </nav>
    <div class="px-6 py-4 mt-auto">
      <button class="mt-4 w-full bg-red-600 hover:bg-red-700 text-white py-2 px-4 rounded flex items-center justify-center">
        <i class="fas fa-sign-out-alt mr-2"></i> Logout
      </button>
    </div>
  </div>

  <!-- Main Content -->
  <div class="flex-1 overflow-x-hidden overflow-y-auto">
    <header class="bg-white shadow-md">
      <div class="max-w-7xl mx-auto py-4 px-4 sm:px-6 lg:px-8 flex justify-between items-center">
          <h1 class="text-2xl font-bold text-gray-900">Project and Financial Resolution</h1>
          <div class="flex items-center space-x-2">
            <button class="bg-teal-100 p-2 rounded-full text-teal-600 hover:bg-teal-200">
              <i class="fas fa-bell"></i>
            </button>
          </div>
        </div>
  </header>

    <main class="max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8">
      <!-- Project Proposals Section -->
      <div id="project-proposals" class="mb-8">
        <div class="mb-4">
          <div class="bg-gray-100 p-2 rounded-md inline-block">
            <div class="flex space-x-3">
              <button onclick="openBoardResolutionModal()"
                class="bg-teal-600 hover:bg-teal-700 text-white py-2 px-4 rounded-md flex items-center">
                <i class="fas fa-gavel mr-2"></i> Create Project Resolution
              </button>
            </div>
          </div>
        </div>

         <!-- Add Budget/Project filter dropdown next to status filter -->
         <div class="mb-6 flex flex-col sm:flex-row sm:items-center sm:space-x-4">
            <div class="flex-1 mb-4 sm:mb-0">
              <label for="search" class="sr-only">Search</label>
              <div class="relative">
                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                  <i class="fas fa-search text-gray-400"></i>
                </div>
                <input id="search" type="text" placeholder="Search by title"
                  class="block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm" />
              </div>
            </div>
            <div>
              <label for="statusFilter" class="sr-only">Filter by Status</label>
              <select id="statusFilter"
                class="block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm">
                <option value="">All Statuses</option>
                <option value="Ongoing">Ongoing</option>
                <option value="Pending">Pending</option>
                <option value="Completed">Completed</option>
                <option value="Approved">Approved</option>
                <option value="Past Due">Past Due</option>
              </select>
            </div>
            <!-- Add Budget/Project type filter -->
            <div>
              <label for="typeFilter" class="sr-only">Filter by Type</label>
              <select id="typeFilter"
                class="block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm">
                <option value="">All Types</option>
                <option value="Project">Project</option>
                <option value="Budget">Budget</option>
              </select>
            </div>
          </div>

        <div id="project-proposals" class="mb-8"> 
        <h2 class="text-xl font-semibold text-gray-900 mb-6">Resolutions Table</h2>
      </div>

        <div class="bg-white shadow rounded-lg overflow-hidden">
          <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-gray-200">
              <thead class="bg-gray-50">
                <tr>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Particulars</th>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Notes</th>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Project Details</th>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Budget Released</th>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Financial Summary</th>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Project Post</th>
                  </tr>
              </thead>
              <tbody id="proposalsTableBody" class="bg-white divide-y divide-gray-200">
                <!-- Proposals will be rendered dynamically -->
              </tbody>
            </table>
          </div>
        </div>

      </div>
    </main>
  </div>
</div>

<!-- Board Resolution Modal -->
<div id="boardResolutionModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
  <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-screen overflow-y-auto">
    <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center sticky top-0 bg-white z-10">
      <h3 class="text-lg font-medium text-gray-900">Create Board Resolution</h3>
      <button onclick="closeBoardResolutionModal()" class="text-gray-400 hover:text-gray-500">
        <i class="fas fa-times"></i>
      </button>
    </div>
    <div class="p-6">
      <form id="boardResolutionForm" class="space-y-6">
        <div>
          <label for="resolutionTitle" class="block text-sm font-medium text-gray-700">Project Resolution Title</label>
          <input type="text" id="resolutionTitle" name="resolutionTitle" required
            class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm" />
        </div>
        <div>
          <label for="resolutionSummary" class="block text-sm font-medium text-gray-700">Resolution Summary</label>
          <textarea id="resolutionSummary" name="resolutionSummary" rows="4" required
            class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm"
            placeholder="Provide a detailed summary of the board resolution..."></textarea>
        </div>
        <div>
          <label for="estimatedBudget" class="block text-sm font-medium text-gray-700">Estimated Budget</label>
          <input type="number" id="estimatedBudget" name="estimatedBudget" min="0" step="0.01"
            class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm"
            placeholder="Enter estimated budget amount" />
        </div>
        <div>
          <label for="resolutionStartDate" class="block text-sm font-medium text-gray-700">Start Date</label>
          <input type="date" id="resolutionStartDate" name="resolutionStartDate" required
            class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm" />
        </div>
        <div>
          <label for="resolutionTargetCompletion" class="block text-sm font-medium text-gray-700">Date Target Completion</label>
          <input type="date" id="resolutionTargetCompletion" name="resolutionTargetCompletion" required
            class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm" />
        </div>
        <div>
          <label for="resolutionProposedBy" class="block text-sm font-medium text-gray-700">Proposed By</label>
          <input type="text" id="resolutionProposedBy" name="resolutionProposedBy" value="HOA Board of Directors" readonly
            class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 bg-gray-100 sm:text-sm" />
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700">Project Proposal Document</label>
          <div class="mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md">
            <div class="space-y-1 text-center">
              <svg class="mx-auto h-12 w-12 text-gray-400" stroke="currentColor" fill="none" viewBox="0 0 48 48" aria-hidden="true">
                <path d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
              </svg>
              <div class="flex text-sm text-gray-600">
                <label for="projectProposalDoc" class="relative cursor-pointer bg-white rounded-md font-medium text-teal-600 hover:text-teal-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-teal-500">
                  <span>Upload project proposal document</span>
                  <input id="projectProposalDoc" name="projectProposalDoc" type="file" accept="application/pdf,.doc,.docx" class="sr-only" />
                </label>
                <p class="pl-1">or drag and drop</p>
              </div>
              <p class="text-xs text-gray-500">PDF, DOC, DOCX up to 10MB</p>
            </div>
          </div>
          <div id="projectProposalPreview" class="mt-2"></div>
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700">Upload Signed Resolution</label>
          <div class="mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md">
            <div class="space-y-1 text-center">
              <svg class="mx-auto h-12 w-12 text-gray-400" stroke="currentColor" fill="none" viewBox="0 0 48 48" aria-hidden="true">
                <path d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
              </svg>
              <div class="flex text-sm text-gray-600">
                <label for="signedResolution" class="relative cursor-pointer bg-white rounded-md font-medium text-teal-600 hover:text-teal-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-teal-500">
                  <span>Upload signed resolution</span>
                  <input id="signedResolution" name="signedResolution" type="file" accept="application/pdf,.doc,.docx,image/png,image/jpeg" class="sr-only" />
                </label>
                <p class="pl-1">or drag and drop</p>
              </div>
              <p class="text-xs text-gray-500">PDF, DOC, DOCX, PNG, JPG up to 10MB</p>
            </div>
          </div>
          <div id="signedResolutionPreview" class="mt-2"></div>
        </div>
        <div class="flex justify-end space-x-3">
          <button type="button" onclick="closeBoardResolutionModal()"
            class="py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500">
            Cancel
          </button>
          <button type="submit"
            class="py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-teal-600 hover:bg-teal-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500">
            Create Board Resolution
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- View Project Modal (Updated to match Edit Project format - NON-EDITABLE) -->
<div id="viewProjectModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
  <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-screen overflow-y-auto">
    <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center sticky top-0 bg-white z-10">
      <h3 class="text-lg font-medium text-gray-900">Project Proposal Details</h3>
      <button onclick="closeViewProjectModal()" class="text-gray-400 hover:text-gray-500">
        <i class="fas fa-times"></i>
      </button>
    </div>
    <div class="p-6">
      <form class="space-y-6">
        <input type="hidden" id="viewProjectId" />
        <div>
          <label for="viewResolutionTitle" class="block text-sm font-medium text-gray-700">Project Resolution Title</label>
          <p id="viewResolutionTitle" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 bg-gray-100 sm:text-sm"></p>
        </div>
        <div>
          <label for="viewResolutionSummary" class="block text-sm font-medium text-gray-700">Resolution Summary</label>
          <textarea id="viewResolutionSummary" rows="4" readonly
            class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 bg-gray-100 sm:text-sm"></textarea>
        </div>
        <div>
          <label for="viewEstimatedBudget" class="block text-sm font-medium text-gray-700">Estimated Budget</label>
          <input type="text" id="viewEstimatedBudget" readonly
            class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 bg-gray-100 sm:text-sm" />
        </div>
        <div>
          <label for="viewResolutionStartDate" class="block text-sm font-medium text-gray-700">Start Date</label>
          <input type="date" id="viewResolutionStartDate" readonly
            class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 bg-gray-100 sm:text-sm" />
        </div>
        <div>
          <label for="viewResolutionTargetCompletion" class="block text-sm font-medium text-gray-700">Date Target Completion</label>
          <input type="date" id="viewResolutionTargetCompletion" readonly
            class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 bg-gray-100 sm:text-sm" />
        </div>
        <div>
          <label for="viewResolutionProposedBy" class="block text-sm font-medium text-gray-700">Proposed By</label>
          <input type="text" id="viewResolutionProposedBy" readonly
            class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 bg-gray-100 sm:text-sm" />
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700">Project Proposal Document</label>
          <div class="mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md">
            <div class="space-y-1 text-center">
              <svg class="mx-auto h-12 w-12 text-gray-400" stroke="currentColor" fill="none" viewBox="0 0 48 48" aria-hidden="true">
                <path d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
              </svg>
              <div class="flex text-sm text-gray-600">
                <span id="viewProjectProposalDocText" class="bg-white rounded-md font-medium text-teal-600">No document uploaded</span>
              </div>
              <p class="text-xs text-gray-500">PDF, DOC, DOCX up to 10MB</p>
            </div>
          </div>
          <div id="viewProjectProposalPreview" class="mt-2"></div>
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700">Upload Signed Resolution</label>
          <div class="mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md">
            <div class="space-y-1 text-center">
              <svg class="mx-auto h-12 w-12 text-gray-400" stroke="currentColor" fill="none" viewBox="0 0 48 48" aria-hidden="true">
                <path d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
              </svg>
              <div class="flex text-sm text-gray-600">
                <span id="viewSignedResolutionText" class="bg-white rounded-md font-medium text-teal-600">No document uploaded</span>
              </div>
              <p class="text-xs text-gray-500">PDF, DOC, DOCX, PNG, JPG up to 10MB</p>
            </div>
          </div>
          <div id="viewSignedResolutionPreview" class="mt-2"></div>
        </div>
        <div class="flex justify-end space-x-3">
          <button type="button" onclick="closeViewProjectModal()"
            class="py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500">
            Close
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Edit Project Modal -->
<div id="editProjectModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
  <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-screen overflow-y-auto">
    <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center sticky top-0 bg-white z-10">
      <h3 class="text-lg font-medium text-gray-900">Edit Project Proposal</h3>
      <button onclick="closeEditProjectModal()" class="text-gray-400 hover:text-gray-500">
        <i class="fas fa-times"></i>
      </button>
    </div>
    <div class="p-6">
      <form id="editProjectForm" class="space-y-6">
        <input type="hidden" id="editProjectId" />
        <div>
          <label for="editResolutionTitle" class="block text-sm font-medium text-gray-700">Project Resolution Title</label>
          <input type="text" id="editResolutionTitle" name="editResolutionTitle" required
            class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm" />
        </div>
        <div>
          <label for="editResolutionSummary" class="block text-sm font-medium text-gray-700">Resolution Summary</label>
          <textarea id="editResolutionSummary" name="editResolutionSummary" rows="4" required
            class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm"
            placeholder="Provide a detailed summary of the board resolution..."></textarea>
        </div>
        <div>
          <label for="editEstimatedBudget" class="block text-sm font-medium text-gray-700">Estimated Budget</label>
          <input type="number" id="editEstimatedBudget" name="editEstimatedBudget" min="0" step="0.01"
            class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm"
            placeholder="Enter estimated budget amount" />
        </div>
        <div>
          <label for="editResolutionStartDate" class="block text-sm font-medium text-gray-700">Start Date</label>
          <input type="date" id="editResolutionStartDate" name="editResolutionStartDate" required
            class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm" />
        </div>
        <div>
          <label for="editResolutionTargetCompletion" class="block text-sm font-medium text-gray-700">Date Target Completion</label>
          <input type="date" id="editResolutionTargetCompletion" name="editResolutionTargetCompletion" required
            class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm" />
        </div>
        <div>
          <label for="editResolutionProposedBy" class="block text-sm font-medium text-gray-700">Proposed By</label>
          <input type="text" id="editResolutionProposedBy" name="editResolutionProposedBy" readonly
            class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 bg-gray-100 sm:text-sm" />
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700">Project Proposal Document</label>
          <div class="mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md">
            <div class="space-y-1 text-center">
              <svg class="mx-auto h-12 w-12 text-gray-400" stroke="currentColor" fill="none" viewBox="0 0 48 48" aria-hidden="true">
                <path d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
              </svg>
              <div class="flex text-sm text-gray-600">
                <label for="editProjectProposalDoc" class="relative cursor-pointer bg-white rounded-md font-medium text-teal-600 hover:text-teal-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-teal-500">
                  <span>Upload project proposal document</span>
                  <input id="editProjectProposalDoc" name="editProjectProposalDoc" type="file" accept="application/pdf,.doc,.docx" class="sr-only" />
                </label>
                <p class="pl-1">or drag and drop</p>
              </div>
              <p class="text-xs text-gray-500">PDF, DOC, DOCX up to 10MB</p>
            </div>
          </div>
          <div id="editProjectProposalPreview" class="mt-2"></div>
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700">Upload Signed Resolution</label>
          <div class="mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md">
            <div class="space-y-1 text-center">
              <svg class="mx-auto h-12 w-12 text-gray-400" stroke="currentColor" fill="none" viewBox="0 0 48 48" aria-hidden="true">
                <path d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
              </svg>
              <div class="flex text-sm text-gray-600">
                <label for="editSignedResolution" class="relative cursor-pointer bg-white rounded-md font-medium text-teal-600 hover:text-teal-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-teal-500">
                  <span>Upload signed resolution</span>
                  <input id="editSignedResolution" name="editSignedResolution" type="file" accept="application/pdf,.doc,.docx,image/png,image/jpeg" class="sr-only" />
                </label>
                <p class="pl-1">or drag and drop</p>
              </div>
              <p class="text-xs text-gray-500">PDF, DOC, DOCX, PNG, JPG up to 10MB</p>
            </div>
          </div>
          <div id="editSignedResolutionPreview" class="mt-2"></div>
        </div>
        <div class="flex justify-end space-x-3">
          <button type="button" onclick="closeEditProjectModal()"
            class="py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500">
            Cancel
          </button>
          <button type="submit"
            class="py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-teal-600 hover:bg-teal-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500">
            Update Project
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Notes Modal -->
<div id="notesModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
  <div class="bg-white rounded-lg shadow-xl max-w-lg w-full">
    <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
      <h3 class="text-lg font-medium text-gray-900">President's Notes</h3>
      <button onclick="closeNotesModal()" class="text-gray-400 hover:text-gray-500">
        <i class="fas fa-times"></i>
      </button>
    </div>
    <div class="p-6">
      <p id="notesContent" class="text-sm text-gray-900"></p>
      <div class="mt-6 flex justify-end">
        <button type="button" onclick="closeNotesModal()"
          class="py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500">
          Close
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Project Post Modal -->
<div id="projectPostModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
  <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-screen overflow-y-auto">
    <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center sticky top-0 bg-white z-10">
      <h3 class="text-lg font-medium text-gray-900">Create Project Post</h3>
      <button onclick="closeProjectPostModal()" class="text-gray-400 hover:text-gray-500">
        <i class="fas fa-times"></i>
      </button>
    </div>
    <div class="p-6">
      <form id="projectPostForm" class="space-y-6">
        <div>
          <label for="postProjectTitle" class="block text-sm font-medium text-gray-700">Project Title</label>
          <input type="text" id="postProjectTitle" name="postProjectTitle" required
            class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm" />
        </div>
        <div>
          <label for="postDescription" class="block text-sm font-medium text-gray-700">Description</label>
          <textarea id="postDescription" name="postDescription" rows="4" required
            class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm"></textarea>
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700">Project Images</label>
          <div class="mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md">
            <div class="space-y-1 text-center">
              <svg class="mx-auto h-12 w-12 text-gray-400" stroke="currentColor" fill="none" viewBox="0 0 48 48" aria-hidden="true">
                <path d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
              </svg>
              <div class="flex text-sm text-gray-600">
                <label for="postImages" class="relative cursor-pointer bg-white rounded-md font-medium text-teal-600 hover:text-teal-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-teal-500">
                  <span>Upload images</span>
                  <input id="postImages" name="postImages" type="file" accept="image/png,image/jpeg" multiple class="sr-only" />
                </label>
                <p class="pl-1">or drag and drop</p>
              </div>
              <p class="text-xs text-gray-500">PNG, JPG up to 10MB</p>
            </div>
          </div>
          <div id="postImagePreview" class="mt-2 grid grid-cols-2 gap-2"></div>
        </div>
        <div class="flex justify-end space-x-3">
          <button type="button" onclick="closeProjectPostModal()"
            class="py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500">
            Cancel
          </button>
          <button type="submit"
            class="py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-teal-600 hover:bg-teal-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500">
            Create Post
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Budget Release Details Modal (INCREASED SPACING TO space-y-12) -->
<div id="budgetReleasedModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
  <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-screen overflow-y-auto">
    <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center sticky top-0 bg-white z-10">
      <h3 class="text-lg font-medium text-gray-900">Budget Release Details</h3>
      <button onclick="closeBudgetReleasedModal()" class="text-gray-400 hover:text-gray-500">
        <i class="fas fa-times"></i>
      </button>
    </div>
    <div class="p-6">
      <div class="space-y-12">
        <!-- PROJECT FORMAT (Basketball Court, Street Lighting, Community Garden) -->
        <div id="projectBudgetFields">
          <div>
            <label class="block text-sm font-medium text-gray-700">Project Title</label>
            <p id="budgetProjectTitle" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 bg-gray-100 sm:text-sm"></p>
          </div>
          <br>
          <div>
            <label class="block text-sm font-medium text-gray-700">Amount Released</label>
            <p id="budgetAmountReleased" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 bg-gray-100 sm:text-sm"></p>
          </div>
          <br>
          <div>
            <label class="block text-sm font-medium text-gray-700">Recipient</label>
            <p id="budgetRecipient" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 bg-gray-100 sm:text-sm"></p>
          </div>
          <br>
          <div>
            <label class="block text-sm font-medium text-gray-700">Release Date</label>
            <p id="budgetReleaseDate" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 bg-gray-100 sm:text-sm"></p>
          </div>
          <br>
          <div>
            <label class="block text-sm font-medium text-gray-700">Payment Method</label>
            <p id="budgetPaymentMethod" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 bg-gray-100 sm:text-sm"></p>
          </div>
          <br>
          <div>
            <label class="block text-sm font-medium text-gray-700">Reference Number</label>
            <p id="budgetReferenceNumber" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 bg-gray-100 sm:text-sm"></p>
          </div>
          <br>
          <div>
            <label class="block text-sm font-medium text-gray-700">Acknowledgement Receipt</label>
            <p id="budgetAcknowledgement" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 bg-gray-100 sm:text-sm"></p>
          </div>
          <br>
          <div>
            <label class="block text-sm font-medium text-gray-700">Purpose</label>
            <p id="budgetPurpose" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 bg-gray-100 sm:text-sm"></p>
          </div>
          <br>
          <div>
            <label class="block text-sm font-medium text-gray-700">Approval Notes</label>
            <p id="budgetApprovalNotes" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 bg-gray-100 sm:text-sm"></p>
          </div>
        </div>
        
        <!-- PAYROLL FORMAT (Admin Payroll - Month of October 2025) -->
        <div id="payrollBudgetFields" style="display: none;">
          <div>
            <label class="block text-sm font-medium text-gray-700">Particulars</label>
            <p id="budgetParticulars" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 bg-gray-100 sm:text-sm"></p>
          </div>
          <br>
          <div>
            <label class="block text-sm font-medium text-gray-700">Date</label>
            <p id="budgetDate" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 bg-gray-100 sm:text-sm"></p>
          </div>
          <br>
          <div>
            <label class="block text-sm font-medium text-gray-700">Transaction Type</label>
            <p id="budgetTransactionType" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 bg-gray-100 sm:text-sm"></p>
          </div>
          <br>
          <div>
            <label class="block text-sm font-medium text-gray-700">Name of Payer</label>
            <p id="budgetPayer" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 bg-gray-100 sm:text-sm"></p>
          </div>
          <br>
          <div>
            <label class="block text-sm font-medium text-gray-700">Name of Receiver</label>
            <p id="budgetReceiver" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 bg-gray-100 sm:text-sm"></p>
          </div>
          <br>
          <div>
            <label class="block text-sm font-medium text-gray-700">Payment Method</label>
            <p id="budgetPaymentMethodPayroll" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 bg-gray-100 sm:text-sm"></p>
          </div>
          <br>
          <div>
            <label class="block text-sm font-medium text-gray-700">Reference Number</label>
            <p id="budgetReferenceNumberPayroll" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 bg-gray-100 sm:text-sm"></p>
          </div>
          <br>
          <div>
            <label class="block text-sm font-medium text-gray-700">Acknowledgement Receipt</label>
            <p id="budgetAcknowledgementPayroll" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 bg-gray-100 sm:text-sm"></p>
          </div>
          <br>
          <div>
            <label class="block text-sm font-medium text-gray-700">Remarks</label>
            <p id="budgetRemarks" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 bg-gray-100 sm:text-sm"></p>
          </div>
        </div>
      </div>
      <div class="mt-6 flex justify-end">
        <button type="button" onclick="closeBudgetReleasedModal()"
          class="py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500">
          Close
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Audit File Modal -->
<div id="auditFileModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
  <div class="bg-white rounded-lg shadow-xl max-w-lg w-full">
    <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
      <h3 class="text-lg font-medium text-gray-900">Audit File</h3>
      <button onclick="closeAuditFileModal()" class="text-gray-400 hover:text-gray-500">
        <i class="fas fa-times"></i>
      </button>
    </div>
    <div class="p-6">
      <div id="auditFileContent" class="text-sm text-gray-900"></div>
      <div class="mt-6 flex justify-end">
        <button type="button" onclick="closeAuditFileModal()"
          class="py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500">
          Close
        </button>
      </div>
    </div>
  </div>
</div>

<script>
    // Simulated in-memory data store for project proposals (ADDED NEW PAYROLL ENTRY)
    let projectProposals = [
      {
        id: 1,
        projectTitle: "Basketball Court Renovation",
        description: "Repainting and installing new hoops and benches",
        startDate: "2025-03-01",
        targetCompletion: "2025-04-01",
        proposedBy: "HOA Board of Directors",
        budgetBreakdown: "Paint: ₱15,000, Hoops: ₱20,000, Benches: ₱10,000",
        estimatedBudget: "45000",
        status: "Past Due",
        projectProposalDoc: "court_design.jpg",
        signedResolutionFile: null,
        auditFile: "basketball_audit.pdf",
        notes: "",
        hasPost: false,
        budgetReleased: {
          projectId: 1,
          projectTitle: "Basketball Court Renovation",
          amountReleased: "20000",
          recipient: "John Doe Contracting",
          releaseDate: "2025-03-15",
          paymentMethod: "Bank Transfer",
          referenceNumber: "TXN123456",
          proofOfRelease: "payment_proof.jpg",
          purpose: "Initial payment for repainting and materials",
          approvalNotes: "Approved by treasurer on 2025-03-14"
        },
        isPayroll: false
      },
      {
        id: 2,
        projectTitle: "Parking Lot Expansion",
        description: "Expanding parking spaces near the clubhouse",
        startDate: "2025-05-01",
        targetCompletion: "2025-08-15",
        proposedBy: "HOA Board of Directors",
        budgetBreakdown: "Pavement: ₱30,000, Markings: ₱20,000",
        estimatedBudget: "50000",
        status: "Pending",
        projectProposalDoc: null,
        signedResolutionFile: null,
        auditFile: null,
        notes: "",
        hasPost: false,
        budgetReleased: null,
        isPayroll: false
      },
      {
        id: 3,
        projectTitle: "Street Lighting Upgrade",
        description: "Replacing old street lights with energy-efficient LED lights",
        startDate: "2023-03-15",
        targetCompletion: "2023-04-20",
        proposedBy: "HOA Board of Directors",
        budgetBreakdown: "LED Lights: ₱60,000, Installation: ₱20,000, Permits: ₱5,000",
        estimatedBudget: "85000",
        status: "Completed",
        projectProposalDoc: "lighting_plan.pdf",
        signedResolutionFile: "signed_lighting_res.pdf",
        auditFile: "lighting_audit.pdf",
        notes: "",
        hasPost: true,
        budgetReleased: {
          projectId: 3,
          projectTitle: "Street Lighting Upgrade",
          amountReleased: "85000",
          recipient: "BrightFuture Ltd.",
          releaseDate: "2023-03-20",
          paymentMethod: "Check",
          referenceNumber: "CHK789012",
          proofOfRelease: "check_scan.jpg",
          purpose: "Full payment for LED lights and installation",
          approvalNotes: "Final approval by board"
        },
        isPayroll: false
      },
      {
        id: 4,
        projectTitle: "Luxury Fountain Installation",
        description: "Installing a decorative fountain in the park",
        startDate: "2023-01-15",
        targetCompletion: "2023-03-31",
        proposedBy: "HOA Board of Directors",
        budgetBreakdown: "Fountain: ₱100,000, Installation: ₱50,000",
        estimatedBudget: "150000",
        status: "Rejected",
        projectProposalDoc: "fountain_design.pdf",
        signedResolutionFile: null,
        auditFile: null,
        notes: "Budget too high for current fiscal year.",
        hasPost: false,
        budgetReleased: null,
        isPayroll: false
      },
      {
        id: 5,
        projectTitle: "Community Garden Setup",
        description: "Creating a community garden for residents",
        startDate: "2025-01-15",
        targetCompletion: "2025-06-30",
        proposedBy: "HOA Board of Directors",
        budgetBreakdown: "Seeds: ₱5,000, Tools: ₱15,000, Soil: ₱10,000",
        estimatedBudget: "30000",
        status: "Ongoing",
        projectProposalDoc: "garden_plan.pdf",
        signedResolutionFile: null,
        auditFile: "garden_audit.pdf",
        notes: "",
        hasPost: false,
        budgetReleased: {
          projectId: 5,
          projectTitle: "Community Garden Setup",
          amountReleased: "15000",
          recipient: "GreenThumb Supplies",
          releaseDate: "2025-01-20",
          paymentMethod: "Cash",
          referenceNumber: "",
          proofOfRelease: "receipt_scan.jpg",
          purpose: "Purchase of seeds and tools",
          approvalNotes: ""
        },
        isPayroll: false
      },
      // NEW PAYROLL ENTRY
      {
        id: 6,
        projectTitle: "Admin Payroll - Month of October 2025",
        description: "Monthly administrative staff salaries",
        startDate: "2025-10-01",
        targetCompletion: "2025-10-31",
        proposedBy: "HOA Board of Directors",
        budgetBreakdown: "Admin Staff Salaries",
        estimatedBudget: "25000",
        status: "Completed",
        projectProposalDoc: null,
        signedResolutionFile: null,
        auditFile: "payroll_october_2025.pdf",
        notes: "",
        hasPost: false,
        budgetReleased: {
          projectId: 6,
          particulars: "Admin Payroll - Month of October 2025",
          date: "2025-10-15",
          transactionType: "Payroll",
          payer: "Mabuhay Homes 2000 HOA",
          receiver: "Admin Staff",
          paymentMethod: "Bank Transfer",
          referenceNumber: "PAY20251015",
          acknowledgementReceipt: "AR-20251015.pdf",
          remarks: "October 2025 salaries processed"
        },
        isPayroll: true
      }
    ];
  
    document.addEventListener('DOMContentLoaded', function() {
      const boardResolutionForm = document.getElementById('boardResolutionForm');
      const editProjectForm = document.getElementById('editProjectForm');
      const projectPostForm = document.getElementById('projectPostForm');
      const searchInput = document.getElementById('search');
      const statusFilter = document.getElementById('statusFilter');
      const typeFilter = document.getElementById('typeFilter');
      const postImageInput = document.getElementById('postImages');
      const projectProposalDocInput = document.getElementById('projectProposalDoc');
      const signedResolutionInput = document.getElementById('signedResolution');
      const editProjectProposalDocInput = document.getElementById('editProjectProposalDoc');
      const editSignedResolutionInput = document.getElementById('editSignedResolution');

      // Project Proposal Document upload validation and preview
      projectProposalDocInput.addEventListener('change', function() {
        handleFileUpload(this, 'projectProposalPreview');
      });
  
      // Signed Resolution upload validation and preview
      signedResolutionInput.addEventListener('change', function() {
        handleFileUpload(this, 'signedResolutionPreview');
      });
  
      // Edit modal file uploads
      editProjectProposalDocInput.addEventListener('change', function() {
        handleFileUpload(this, 'editProjectProposalPreview');
      });
  
      editSignedResolutionInput.addEventListener('change', function() {
        handleFileUpload(this, 'editSignedResolutionPreview');
      });
  
      // Image upload validation and preview for Project Post
      postImageInput.addEventListener('change', function() {
        const preview = document.getElementById('postImagePreview');
        preview.innerHTML = '';
        Array.from(postImageInput.files).forEach(file => {
          if (file.type.match('image.*') && file.size <= 10 * 1024 * 1024) {
            const img = document.createElement('img');
            img.src = URL.createObjectURL(file);
            img.className = 'rounded-lg w-full h-24 object-cover';
            preview.appendChild(img);
          } else {
            alert('Please upload PNG or JPG images under 10MB.');
            postImageInput.value = '';
            preview.innerHTML = '';
          }
        });
      });
  
      // Board Resolution Form submission (REMOVED AUDIT FILE)
      boardResolutionForm.addEventListener('submit', function(e) {
        e.preventDefault();
  
        const newResolution = {
          id: Math.max(...projectProposals.map(p => p.id), 0) + 1,
          projectTitle: document.getElementById('resolutionTitle').value,
          description: document.getElementById('resolutionSummary').value,
          estimatedBudget: document.getElementById('estimatedBudget').value || "0",
          startDate: document.getElementById('resolutionStartDate').value,
          targetCompletion: document.getElementById('resolutionTargetCompletion').value,
          proposedBy: document.getElementById('resolutionProposedBy').value,
          budgetBreakdown: "N/A",
          status: "Pending",
          projectProposalDoc: projectProposalDocInput.files[0] ? projectProposalDocInput.files[0].name : null,
          signedResolutionFile: signedResolutionInput.files[0] ? signedResolutionInput.files[0].name : null,
          auditFile: null,
          notes: "",
          hasPost: false,
          budgetReleased: null,
          isPayroll: false
        };
  
        projectProposals.push(newResolution);
        alert('Board resolution created successfully!');
        closeBoardResolutionModal();
        boardResolutionForm.reset();
        document.getElementById('projectProposalPreview').innerHTML = '';
        document.getElementById('signedResolutionPreview').innerHTML = '';
        renderProjectProposals();
      });
  
      // Edit Project Form submission (REMOVED AUDIT FILE)
      editProjectForm.addEventListener('submit', function(e) {
        e.preventDefault();
  
        const projectId = parseInt(document.getElementById('editProjectId').value);
        const proposal = projectProposals.find(p => p.id === projectId);
  
        if (proposal) {
          proposal.projectTitle = document.getElementById('editResolutionTitle').value;
          proposal.description = document.getElementById('editResolutionSummary').value;
          proposal.estimatedBudget = document.getElementById('editEstimatedBudget').value || "0";
          proposal.startDate = document.getElementById('editResolutionStartDate').value;
          proposal.targetCompletion = document.getElementById('editResolutionTargetCompletion').value;
          proposal.proposedBy = document.getElementById('editResolutionProposedBy').value;
  
          if (editProjectProposalDocInput.files[0]) {
            proposal.projectProposalDoc = editProjectProposalDocInput.files[0].name;
          }
          if (editSignedResolutionInput.files[0]) {
            proposal.signedResolutionFile = editSignedResolutionInput.files[0].name;
          }
  
          alert('Project updated successfully!');
          closeEditProjectModal();
          renderProjectProposals();
        }
      });
  
      // Project Post Form submission
      projectPostForm.addEventListener('submit', function(e) {
        e.preventDefault();
        const projectId = projectPostForm.dataset.projectId;
        const proposal = projectProposals.find(p => p.id === parseInt(projectId));
        if (proposal) {
          proposal.hasPost = true;
          proposal.status = 'Completed';
          closeProjectPostModal();
          projectPostForm.reset();
          document.getElementById('postImagePreview').innerHTML = '';
          renderProjectProposals();
          alert('Project post created and project marked as completed!');
        }
      });
  
      // Filter and search event listeners
      searchInput.addEventListener('input', filterProposals);
      statusFilter.addEventListener('change', filterProposals);
      typeFilter.addEventListener('change', filterProposals);

      // Initial render
      renderProjectProposals();
    });
  
    function handleFileUpload(input, previewId, isImageOnly = false) {
      const preview = document.getElementById(previewId);
      preview.innerHTML = '';
      const file = input.files[0];
      if (file) {
        const isValidType = isImageOnly
          ? file.type.match('image/png') || file.type.match('image/jpeg')
          : file.type.match('application/pdf') ||
            file.type.match('application/msword') ||
            file.type.match('application/vnd.openxmlformats-officedocument.wordprocessingml.document') ||
            file.type.match('image/png') ||
            file.type.match('image/jpeg');
  
        if (isValidType && file.size <= 10 * 1024 * 1024) {
          if (isImageOnly && file.type.match('image.*')) {
            const img = document.createElement('img');
            img.src = URL.createObjectURL(file);
            img.className = 'rounded-lg w-full h-24 object-cover';
            preview.appendChild(img);
          } else {
            const div = document.createElement('div');
            const icon = file.type.match('image/') ? 'fas fa-image' : 'fas fa-file-alt';
            div.innerHTML = `<i class="${icon} mr-2 text-teal-600"></i><span class="text-sm text-gray-600">${file.name}</span>`;
            div.className = 'flex items-center';
            preview.appendChild(div);
          }
        } else {
          alert(`Please upload ${isImageOnly ? 'PNG or JPG images' : 'valid files'} under 10MB.`);
          input.value = '';
          preview.innerHTML = '';
        }
      }
    }
  
    function filterProposals() {
      const searchTerm = document.getElementById('search').value.toLowerCase();
      const statusValue = document.getElementById('statusFilter').value;
      const typeValue = document.getElementById('typeFilter').value;

      const filteredProposals = projectProposals.filter(proposal => {
        const matchesSearch = proposal.projectTitle.toLowerCase().includes(searchTerm);
        const matchesStatus = statusValue ? proposal.status === statusValue : true;
        const matchesType = typeValue ? (typeValue === 'Budget' ? proposal.isPayroll : !proposal.isPayroll) : true;
        return matchesSearch && matchesStatus && matchesType;
      });

      renderProjectProposals(filteredProposals);
    }
  
    function renderProjectProposals(proposals = projectProposals) {
      const tbody = document.getElementById('proposalsTableBody');
      tbody.innerHTML = '';
  
      if (!proposals || proposals.length === 0) {
        tbody.innerHTML = `<tr><td colspan="7" class="px-6 py-4 text-center text-sm text-gray-500">No project proposals found.</td></tr>`;
        return;
      }
  
      proposals.forEach(proposal => {
        const statusMap = {
          Ongoing: 'bg-yellow-100 text-yellow-800',
          Pending: 'bg-blue-100 text-blue-800',
          Completed: 'bg-green-100 text-green-800',
          Rejected: 'bg-red-100 text-red-800',
          'Past Due': 'bg-orange-100 text-orange-800'
        };
        const statusColor = statusMap[proposal.status] || 'bg-gray-100 text-gray-800';
        const showNotes = proposal.status === 'Rejected' && proposal.notes;
        const canCreatePost = (proposal.status === 'Ongoing' || proposal.status === 'Past Due') && !proposal.hasPost;
        const isCompletedWithPost = proposal.status === 'Completed' && proposal.hasPost;
        const showViewButton = !proposal.isPayroll && !['Pending', 'Rejected'].includes(proposal.status);
        const showEditButton = !proposal.isPayroll && ['Pending', 'Rejected'].includes(proposal.status);
        const showBudgetReleasedButton = ['Ongoing', 'Past Due', 'Completed'].includes(proposal.status);

        tbody.innerHTML += `
          <tr>
            <td class="px-6 py-4 whitespace-nowrap">
              <div class="text-sm font-medium text-gray-900">${proposal.projectTitle}</div>
            </td>
            <td class="px-6 py-4 whitespace-nowrap">
              <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${statusColor}">
                ${proposal.status}
              </span>
            </td>
            <td class="px-6 py-4 whitespace-nowrap">
              ${showNotes ? `
                <div class="inline-block">
                  <button onclick='openNotesModal(${JSON.stringify(proposal.notes)})'
                    class="bg-teal-600 hover:bg-teal-700 text-white py-1 px-3 rounded-md text-sm inline-flex items-center justify-center w-20">
                    Notes
                  </button>
                </div>
              ` : ''}
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
              <div class="flex space-x-2">
                ${showViewButton ? `
                  <button onclick="openViewProjectModal(${proposal.id})"
                    class="bg-teal-600 hover:bg-teal-700 text-white py-1 px-3 rounded-md text-sm inline-flex items-center justify-center w-20">
                    View
                  </button>
                ` : ''}
                ${showEditButton ? `
                  <button onclick="openEditProjectModal(${proposal.id})"
                    class="bg-teal-600 hover:bg-teal-700 text-white py-1 px-3 rounded-md text-sm inline-flex items-center justify-center w-20">
                    Edit
                  </button>
                ` : ''}
              </div>
            </td>
            <td class="px-6 py-4 whitespace-nowrap">
              ${showBudgetReleasedButton ? `
                <div class="inline-block">
                  <button onclick="openBudgetReleasedModal(${proposal.id})"
                    class="bg-teal-600 hover:bg-teal-700 text-white py-1 px-3 rounded-md text-sm inline-flex items-center justify-center w-20">
                    View
                  </button>
                </div>
              ` : ''}
            </td>
            <td class="px-6 py-4 whitespace-nowrap">
              ${proposal.auditFile ? `
                <div class="inline-block">
                  <button onclick="openAuditFileModal('${proposal.auditFile}')"
                    class="bg-teal-600 hover:bg-teal-700 text-white py-1 px-3 rounded-md text-sm inline-flex items-center justify-center w-20">
                    View
                  </button>
                </div>
              ` : ''}
            </td>
            <td class="px-6 py-4 whitespace-nowrap">
              ${canCreatePost ? `
                <div class="inline-block">
                  <button onclick="openProjectPostModal(${proposal.id})"
                    class="bg-teal-600 hover:bg-teal-700 text-white py-1 px-3 rounded-md text-sm inline-flex items-center justify-center w-28">
                    Create Post
                  </button>
                </div>
              ` : isCompletedWithPost ? `
                <div class="inline-block">
                  <a href="sec-newsfeed.html"
                    class="bg-teal-600 hover:bg-teal-700 text-white py-1 px-3 rounded-md text-sm inline-flex items-center justify-center w-28">
                    View Post
                  </a>
                </div>
              ` : ''}
            </td>
          </tr>
        `;
      });
    }
  
    // View Project Modal Functions (NON-EDITABLE format matching Edit modal)
    function openViewProjectModal(id) {
      const proposal = projectProposals.find(p => p.id === id);
      if (proposal) {
        document.getElementById('viewProjectId').value = proposal.id;
        document.getElementById('viewResolutionTitle').textContent = proposal.projectTitle;
        document.getElementById('viewResolutionSummary').value = proposal.description;
        document.getElementById('viewEstimatedBudget').value = proposal.estimatedBudget || '';
        document.getElementById('viewResolutionStartDate').value = proposal.startDate;
        document.getElementById('viewResolutionTargetCompletion').value = proposal.targetCompletion;
        document.getElementById('viewResolutionProposedBy').value = proposal.proposedBy || 'HOA Board of Directors';

        // Project Proposal Document
        const viewProposalText = document.getElementById('viewProjectProposalDocText');
        const viewProposalPreview = document.getElementById('viewProjectProposalPreview');
        viewProposalPreview.innerHTML = '';
        if (proposal.projectProposalDoc) {
          viewProposalText.textContent = proposal.projectProposalDoc;
          const div = document.createElement('div');
          div.innerHTML = `<i class="fas fa-file-alt mr-2 text-teal-600"></i><span class="text-sm text-gray-600">${proposal.projectProposalDoc}</span>`;
          div.className = 'flex items-center';
          viewProposalPreview.appendChild(div);
        } else {
          viewProposalText.textContent = 'No document uploaded';
        }

        // Signed Resolution
        const viewSignedText = document.getElementById('viewSignedResolutionText');
        const viewSignedPreview = document.getElementById('viewSignedResolutionPreview');
        viewSignedPreview.innerHTML = '';
        if (proposal.signedResolutionFile) {
          viewSignedText.textContent = proposal.signedResolutionFile;
          const div = document.createElement('div');
          div.innerHTML = `<i class="fas fa-file-alt mr-2 text-teal-600"></i><span class="text-sm text-gray-600">${proposal.signedResolutionFile}</span>`;
          div.className = 'flex items-center';
          viewSignedPreview.appendChild(div);
        } else {
          viewSignedText.textContent = 'No document uploaded';
        }

        document.getElementById('viewProjectModal').classList.remove('hidden');
        document.body.classList.add('overflow-hidden');
      }
    }

    function closeViewProjectModal() {
      document.getElementById('viewProjectModal').classList.add('hidden');
      document.body.classList.remove('overflow-hidden');
    }
  
    // Edit Project Modal Functions
    function openEditProjectModal(id) {
      const proposal = projectProposals.find(p => p.id === id);
      if (proposal) {
        document.getElementById('editProjectId').value = proposal.id;
        document.getElementById('editResolutionTitle').value = proposal.projectTitle;
        document.getElementById('editResolutionSummary').value = proposal.description;
        document.getElementById('editEstimatedBudget').value = proposal.estimatedBudget || '';
        document.getElementById('editResolutionStartDate').value = proposal.startDate;
        document.getElementById('editResolutionTargetCompletion').value = proposal.targetCompletion;
        document.getElementById('editResolutionProposedBy').value = proposal.proposedBy || 'HOA Board of Directors';
  
        const proposalPreview = document.getElementById('editProjectProposalPreview');
        proposalPreview.innerHTML = '';
        if (proposal.projectProposalDoc) {
          const div = document.createElement('div');
          div.innerHTML = `<i class="fas fa-file-alt mr-2 text-teal-600"></i><span class="text-sm text-gray-600">${proposal.projectProposalDoc}</span>`;
          div.className = 'flex items-center';
          proposalPreview.appendChild(div);
        }
  
        const signedResolutionPreview = document.getElementById('editSignedResolutionPreview');
        signedResolutionPreview.innerHTML = '';
        if (proposal.signedResolutionFile) {
          const div = document.createElement('div');
          div.innerHTML = `<i class="fas fa-file-alt mr-2 text-teal-600"></i><span class="text-sm text-gray-600">${proposal.signedResolutionFile}</span>`;
          div.className = 'flex items-center';
          signedResolutionPreview.appendChild(div);
        }
  
        document.getElementById('editProjectModal').classList.remove('hidden');
        document.body.classList.add('overflow-hidden');
      }
    }
  
    function closeEditProjectModal() {
      document.getElementById('editProjectModal').classList.add('hidden');
      document.body.classList.remove('overflow-hidden');
      document.getElementById('editProjectForm').reset();
      document.getElementById('editProjectProposalPreview').innerHTML = '';
      document.getElementById('editSignedResolutionPreview').innerHTML = '';
    }
  
        // Budget Released Modal Functions (NEW PROJECT FORMAT, PAYROLL UNCHANGED)
        function openBudgetReleasedModal(id) {
      const proposal = projectProposals.find(p => p.id === id);
      if (proposal && proposal.budgetReleased) {
        if (proposal.isPayroll) {
          // PAYROLL FORMAT (UNCHANGED)
          document.getElementById('payrollBudgetFields').style.display = 'block';
          document.getElementById('projectBudgetFields').style.display = 'none';
          document.getElementById('budgetParticulars').textContent = proposal.budgetReleased.particulars;
          document.getElementById('budgetDate').textContent = new Date(proposal.budgetReleased.date).toLocaleDateString();
          document.getElementById('budgetTransactionType').textContent = proposal.budgetReleased.transactionType;
          document.getElementById('budgetPayer').textContent = proposal.budgetReleased.payer;
          document.getElementById('budgetReceiver').textContent = proposal.budgetReleased.receiver;
          document.getElementById('budgetPaymentMethodPayroll').textContent = proposal.budgetReleased.paymentMethod;
          document.getElementById('budgetReferenceNumberPayroll').textContent = proposal.budgetReleased.referenceNumber;
          document.getElementById('budgetAcknowledgementPayroll').textContent = proposal.budgetReleased.acknowledgementReceipt;
          document.getElementById('budgetRemarks').textContent = proposal.budgetReleased.remarks;
        } else {
          // PROJECT FORMAT (NEW)
          document.getElementById('projectBudgetFields').style.display = 'block';
          document.getElementById('payrollBudgetFields').style.display = 'none';
          document.getElementById('budgetProjectTitle').textContent = proposal.budgetReleased.projectTitle;
          document.getElementById('budgetAmountReleased').textContent = `₱${parseFloat(proposal.budgetReleased.amountReleased).toLocaleString()}`;
          document.getElementById('budgetRecipient').textContent = proposal.budgetReleased.recipient;
          document.getElementById('budgetReleaseDate').textContent = new Date(proposal.budgetReleased.releaseDate).toLocaleDateString();
          document.getElementById('budgetPaymentMethod').textContent = proposal.budgetReleased.paymentMethod;
          document.getElementById('budgetReferenceNumber').textContent = proposal.budgetReleased.referenceNumber || 'N/A';
          document.getElementById('budgetAcknowledgement').textContent = proposal.budgetReleased.proofOfRelease || 'N/A';
          document.getElementById('budgetPurpose').textContent = proposal.budgetReleased.purpose || 'N/A';
          document.getElementById('budgetApprovalNotes').textContent = proposal.budgetReleased.approvalNotes || 'N/A';
        }

        document.getElementById('budgetReleasedModal').classList.remove('hidden');
        document.body.classList.add('overflow-hidden');
      }
    }

    function closeBudgetReleasedModal() {
      document.getElementById('budgetReleasedModal').classList.add('hidden');
      document.body.classList.remove('overflow-hidden');
      document.getElementById('projectBudgetFields').style.display = 'none';
      document.getElementById('payrollBudgetFields').style.display = 'none';
    }

    // Notes Modal Functions
    function openNotesModal(notes) {
      document.getElementById('notesContent').textContent = notes || 'No notes available.';
      document.getElementById('notesModal').classList.remove('hidden');
      document.body.classList.add('overflow-hidden');
    }

    function closeNotesModal() {
      document.getElementById('notesModal').classList.add('hidden');
      document.body.classList.remove('overflow-hidden');
    }

    // Project Post Modal Functions
    function openProjectPostModal(id) {
      const proposal = projectProposals.find(p => p.id === id);
      if (proposal) {
        document.getElementById('projectPostForm').dataset.projectId = id;
        document.getElementById('postProjectTitle').value = proposal.projectTitle;
        document.getElementById('postDescription').value = proposal.description || '';
        document.getElementById('projectPostModal').classList.remove('hidden');
        document.body.classList.add('overflow-hidden');
      }
    }

    function closeProjectPostModal() {
      document.getElementById('projectPostModal').classList.add('hidden');
      document.body.classList.remove('overflow-hidden');
      document.getElementById('projectPostForm').reset();
      document.getElementById('postImagePreview').innerHTML = '';
    }

    // Audit File Modal Functions
    function openAuditFileModal(fileName) {
      document.getElementById('auditFileContent').textContent = `Audit file: ${fileName || 'No audit file available.'}`;
      document.getElementById('auditFileModal').classList.remove('hidden');
      document.body.classList.add('overflow-hidden');
    }

    function closeAuditFileModal() {
      document.getElementById('auditFileModal').classList.add('hidden');
      document.body.classList.remove('overflow-hidden');
    }

    // Modal open/close helper functions
    function openBoardResolutionModal() {
      document.getElementById('boardResolutionModal').classList.remove('hidden');
      document.body.classList.add('overflow-hidden');
    }

    function closeBoardResolutionModal() {
      document.getElementById('boardResolutionModal').classList.add('hidden');
      document.body.classList.remove('overflow-hidden');
      document.getElementById('boardResolutionForm').reset();
      document.getElementById('projectProposalPreview').innerHTML = '';
      document.getElementById('signedResolutionPreview').innerHTML = '';
    }
  </script>
</body>
</html>